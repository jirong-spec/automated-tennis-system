<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>12çƒå ´æ¯”è³½ç®¡ç†ï¼ˆç®¡ç†ç‰ˆï¼‰</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
    .court { border: 2px solid #333; border-radius: 8px; padding: 10px; }
    .player-row { display: flex; align-items: center; margin-top: 6px; }
    .player-row input[type="text"] { font-size: 14px; padding: 4px; }
    .name-input { flex: 1; margin-right: 6px; }
    .score-input { width: 50px; text-align: center; }
    textarea { width: 100%; font-size: 14px; margin-top: 10px; resize: vertical; }
    select { width: 100%; margin-top: 8px; font-size: 14px; padding: 4px; }
    button { margin-top: 10px; padding: 6px 12px; font-size: 14px; display: block; width: 100%; }
    #ai-status { font-weight: bold; color: green; margin-bottom: 20px; }
  </style>
</head>
<body>

<h1>12çƒå ´æ¯”è³½ç®¡ç†ï¼ˆç®¡ç†ç‰ˆï¼‰</h1>
<div id="ai-status">âš™ï¸ å¾Œç«¯è‡ªå‹•æ¨¡å¼å·²å•Ÿå‹•ï¼Œå°‡æŒçºŒæ›´æ–°æ¯”åˆ†èˆ‡æ’ç¨‹....</div>
<div id="courts-container" class="grid"></div>

<script>
  const API_BASE = "http://172.20.10.2:3000";  // â† æ›æˆä½ çš„å¯¦éš› server IP
  let courtsCache = [];

  async function loadCourts() {
    try {
      const res = await fetch(`${API_BASE}/courts`);
      const courtsData = await res.json();
      courtsCache = courtsData;
      renderCourts(courtsData);
    } catch (e) {
      alert("âŒ ç„¡æ³•è®€å–çƒå ´è³‡æ–™");
    }
  }

  function renderCourts(data) {
    const container = document.getElementById("courts-container");
    container.innerHTML = "";

    data.forEach((court, i) => {
      const div = document.createElement("div");
      div.className = "court";
      div.innerHTML = `
        <h3 style="text-align:center;">çƒå ´ ${i + 1}</h3>
        <div class="player-row">
          <input type="text" id="player1-${i}" value="${court.player1}" placeholder="é¸æ‰‹1å§“å" class="name-input" />
          <input type="text" id="score1-${i}" value="${court.score1}" class="score-input" placeholder="æ¯”åˆ†" />
        </div>
        <div class="player-row">
          <input type="text" id="player2-${i}" value="${court.player2}" placeholder="é¸æ‰‹2å§“å" class="name-input" />
          <input type="text" id="score2-${i}" value="${court.score2}" class="score-input" placeholder="æ¯”åˆ†" />
        </div>
        <textarea id="nextPlayers-${i}" placeholder="ä¸‹ä¸€å ´æ¯”è³½é¸æ‰‹åå–®" rows="3">${court.nextPlayers || ""}</textarea>
        <div id="status-${i}" style="margin-top:8px;font-weight:bold;">
          ${court.status || "æœªçŸ¥ç‹€æ…‹"}
        </div>
      `;
      container.appendChild(div);
    });
  }

// ä¿å­˜å–®ä¸€çƒå ´è³‡æ–™çš„å‡½æ•¸ï¼ˆæ­¤åŠŸèƒ½åœ¨æ­¤ç‰ˆæœ¬ä¸­æœªç›´æ¥ä½¿ç”¨ï¼Œä½†ä¿ç•™ï¼‰
Â  async function saveCourt(index) {
Â  Â  // æ³¨æ„: ä½ çš„ server.js ä¼¼ä¹æ²’æœ‰ /courts/:index çš„ POST è·¯ç”±ä¾†æ›´æ–°å–®ä¸€çƒå ´ã€‚
Â  Â  // å¦‚æœéœ€è¦æ­¤åŠŸèƒ½ï¼Œéœ€åœ¨ server.js ä¸­æ–°å¢ã€‚
Â  Â  // ç›®å‰ä¸»è¦ä¾é å¾Œç«¯è‡ªå‹•æ›´æ–° courts.jsonã€‚
Â  Â  console.warn("saveCourt å‡½æ•¸åœ¨æ­¤ç‰ˆæœ¬ä¸­æœªè¢«ç›´æ¥èª¿ç”¨ï¼Œå› ç‚ºå¾Œç«¯è² è²¬è‡ªå‹•æ›´æ–°ã€‚");
Â  }

  
// ç•¶é é¢è¼‰å…¥å®Œæˆæ™‚åŸ·è¡Œ
Â  window.onload = async function () {
Â  Â  await loadCourts(); // é¦–æ¬¡è¼‰å…¥çƒå ´è³‡æ–™

Â  Â  // è¨­å®šä¸€å€‹è¨ˆæ™‚å™¨ï¼Œæ¯ 5 ç§’é‡æ–°è¼‰å…¥è³‡æ–™ï¼Œè®“å‰ç«¯é é¢è‡ªå‹•é¡¯ç¤ºå¾Œç«¯æ›´æ–°çš„æœ€æ–°ç‹€æ…‹ã€‚
Â  Â  // é€™æ¨£ï¼Œç®¡ç†ä»‹é¢å°±èƒ½å³æ™‚åæ˜ ç”± server.js è‡ªå‹•è§¸ç™¼çš„ AI è¾¨è­˜å’Œæ’ç¨‹çµæœã€‚
Â  Â  setInterval(async () => {
Â  Â  Â  console.log("ğŸŒ å‰ç«¯æ­£åœ¨é‡æ–°è¼‰å…¥è³‡æ–™ä»¥åŒæ­¥å¾Œç«¯æ›´æ–°...");
Â  Â  Â  await loadCourts();
Â  Â  }, 5000); // ä½ å¯ä»¥æ ¹æ“šéœ€è¦èª¿æ•´åˆ·æ–°é »ç‡ (ä¾‹å¦‚ 5000 æ¯«ç§’ = 5 ç§’)
Â  };
  
</script>

</body>
</html>
